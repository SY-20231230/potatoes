# -*- coding: utf-8 -*-
"""DoroSeeV1

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1RRPJ2yDZOzXs_RTvw6V_CNu46B3V9qIG
"""

from google.colab import drive
drive.mount('/content/drive')

import os
import zipfile

# ì••ì¶• íŒŒì¼ ê²½ë¡œ
zip_path = "/content/drive/MyDrive/DoroSeeV1/DoroSee.v2-doroseev1.yolov5pytorch.zip"
extract_path = "/content/DoroSeeV1"  # ì••ì¶•ì„ í’€ ê²½ë¡œ

# ì••ì¶• í•´ì œ
os.makedirs(extract_path, exist_ok=True)
with zipfile.ZipFile(zip_path, 'r') as zip_ref:
    zip_ref.extractall(extract_path)

import os
import zipfile

# YOLO ë°ì´í„°ì…‹ì´ ì €ì¥ëœ Google Drive ê²½ë¡œ ì„¤ì •
dataset_path = "/content/drive/MyDrive/DoroSeeV1/DoroSee.v2-doroseev1.yolov5pytorch.zip"
extract_path = "/content/DoroSeeV1"  # ì••ì¶• í•´ì œí•  ê²½ë¡œ

# ì••ì¶• í•´ì œ
os.makedirs(extract_path, exist_ok=True)
with zipfile.ZipFile(dataset_path, 'r') as zip_ref:
    zip_ref.extractall(extract_path)

print("ğŸ“‚ ì••ì¶• í•´ì œëœ í´ë” ë‚´ìš©:")
print(os.listdir(extract_path))

import os

# ê²½ë¡œ ì„¤ì •
data_yaml_path = "/content/DoroSeeV1/DoroSee.v2-doroseev1.yolov5pytorch/data.yaml"
directory = os.path.dirname(data_yaml_path)

# ê²½ë¡œê°€ ì—†ìœ¼ë©´ ìƒì„±
os.makedirs(directory, exist_ok=True)

# ìˆ˜ì •ëœ yaml ë‚´ìš©
yaml_content = """train: /content/DoroSeeV1/DoroSee.v2-doroseev1.yolov5pytorch/train/images
val: /content/DoroSeeV1/DoroSee.v2-doroseev1.yolov5pytorch/valid/images
test: /content/DoroSeeV1/DoroSee.v2-doroseev1.yolov5pytorch/test/images

nc: 2
names: ['Crack', 'pothole']

roboflow:
  workspace: dorosee
  project: dorosee
  version: 2
  license: CC BY 4.0
  url: https://universe.roboflow.com/dorosee/dorosee/dataset/2
"""

# ìˆ˜ì •ëœ yaml íŒŒì¼ë¡œ ì €ì¥
with open(data_yaml_path, "w") as f:
    f.write(yaml_content)

data_yaml_path = "/content/DoroSeeV1/data.yaml"

with open(data_yaml_path, "r") as f:
    print(f.read())

# Commented out IPython magic to ensure Python compatibility.
!git clone https://github.com/ultralytics/yolov5.git
# %cd yolov5
!pip install -r requirements.txt  # í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

!python train.py --img 640 --batch 32 --epochs 100 --data "/content/DoroSeeV1/data.yaml" --weights yolov5s.pt